const e={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:e=>e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:e=>null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:e=>null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:e=>`extmap:%d${e.direction?"/%s":"%v"} %s${e.config?" %s":""}`},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:e=>null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format(e){let s="candidate:%s %d %s %d %s %d typ %s";return s+=null!=e.raddr?" raddr %s rport %d":"%v%v",s+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(s+=" generation %d"),s+=null!=e["network-id"]?" network-id %d":"%v",s+=null!=e["network-cost"]?" network-cost %d":"%v",s}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format(e){let s="ssrc:%d";return null!=e.attribute&&(s+=" %s",null!=e.value&&(s+=":%s")),s}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:e=>null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{name:"content",reg:/^content:([^\s]*)/,format:"content:%s"},{name:"label",reg:/^label:([\d]*)/,format:"label:%d"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:e=>e.params?"rid:%s %s %s":"rid:%s %s"},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:e=>`imageattr:%s %s %s${e.dir2?" %s %s":""}`},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:e=>`simulcast:%s %s${e.dir2?" %s %s":""}`},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{push:"invalid",names:["value"]}]};function s(e){return String(Number(e))===e?Number(e):e}function t(e,t,r){const n=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:n&&!t[e.name]&&(t[e.name]={});const a=e.push?{}:n?t[e.name]:t;!function(e,t,r,n){if(n&&!r)t[n]=s(e[1]);else for(let n=0;n<r.length;n+=1)null!=e[n+1]&&(t[r[n]]=s(e[n+1]))}(r.match(e.reg),a,e.names,e.name),e.push&&t[e.push].push(a)}Object.keys(e).forEach(s=>{e[s].forEach(e=>{e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})});const r=RegExp.prototype.test.bind(/^([a-z])=(.*)/);function n(s){const n=[],a={media:n};let m=a;return s.split(/(\r\n|\r|\n)/).filter(r).forEach(s=>{const r=s[0],a=s.slice(2);"m"===r&&(n.push({rtp:[],fmtp:[]}),m=n[n.length-1]);for(let s=0;s<(e[r]||[]).length;s+=1){const n=e[r][s];if(n.reg.test(a))return void t(n,m,a)}}),a.media=n,a}function a(e,t){const r=t.split(/=(.+)/,2);return 2===r.length&&(e[r[0]]=s(r[1])),e}function m(e){return e.split(/\;\s?/).reduce(a,{})}const o=m;function i(e){return e.split(" ").map(Number)}function p(e){const t=[],r=e.split(" ").map(s);for(let e=0;e<r.length;e+=3)t.push({component:r[e],ip:r[e+1],port:r[e+2]});return t}function d(e){return e.split(" ").map(e=>e.substring(1,e.length-1).split(",").reduce(a,{}))}function c(e){return e.split(";").map(e=>e.split(",").map(e=>{let t,r=!1;return"~"!==e[0]?t=s(e):(t=s(e.substring(1,e.length)),r=!0),{scid:t,paused:r}}))}const u=/%[sdv%]/g,l=function(e,s,t){const r=`${e}=${s.format instanceof Function?s.format(s.push?t:t[s.name]):s.format}`,n=[];if(s.names)for(let e=0;e<s.names.length;e+=1){const r=s.names[e];s.name?n.push(t[s.name][r]):n.push(t[s.names[e]])}else n.push(t[s.name]);return function(e,...s){let t=0;const r=s.length;return e.replace(u,e=>{if(t>=r)return e;const n=s[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(n);case"%d":return Number(n);case"%v":return"";default:return n}})}(r,...n)},f=["v","o","s","i","u","e","p","c","b","t","r","z","a"],g=["i","c","b","a"];function h(s,t){t=t||{},null==s.version&&(s.version=0),null==s.name&&(s.name=" "),s.media.forEach(e=>{null==e.payloads&&(e.payloads="")});const r=t.outerOrder||f,n=t.innerOrder||g,a=[];return r.forEach(t=>{e[t].forEach(e=>{e.name in s&&null!=s[e.name]?a.push(l(t,e,s)):e.push in s&&null!=s[e.push]&&s[e.push].forEach(s=>{a.push(l(t,e,s))})})}),s.media.forEach(s=>{a.push(l("m",e.m[0],s)),n.forEach(t=>{e[t].forEach(e=>{e.name in s&&null!=s[e.name]?a.push(l(t,e,s)):e.push in s&&null!=s[e.push]&&s[e.push].forEach(s=>{a.push(l(t,e,s))})})})}),`${a.join("\r\n")}\r\n`}var S={write:h,parse:n,parseFmtpConfig:o,parseRemoteCandidates:p,parseParams:m,parsePayloads:i,parseImageAttributes:d,parseSimulcastStreamList:c};export default S;export{a as paramReducer,n as parse,o as parseFmtpConfig,d as parseImageAttributes,m as parseParams,i as parsePayloads,t as parseReg,p as parseRemoteCandidates,c as parseSimulcastStreamList,h as write};
