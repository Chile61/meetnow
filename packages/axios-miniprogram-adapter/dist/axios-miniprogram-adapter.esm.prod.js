var e=Object.prototype.toString;
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */function t(t){return"[object Array]"===e.call(t)}function n(e){return null!==e&&"object"==typeof e}function r(t){return"[object Function]"===e.call(t)}function o(e,n){if(null!=e)if("object"!=typeof e&&(e=[e]),t(e))for(var r=0,o=e.length;r<o;r++)n.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&n.call(null,e[i],i,e)}var i={isArray:t,isArrayBuffer:function(t){return"[object ArrayBuffer]"===e.call(t)},isBuffer:function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:n,isUndefined:function(e){return void 0===e},isDate:function(t){return"[object Date]"===e.call(t)},isFile:function(t){return"[object File]"===e.call(t)},isBlob:function(t){return"[object Blob]"===e.call(t)},isFunction:r,isStream:function(e){return n(e)&&r(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:o,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,i=arguments.length;r<i;r++)o(arguments[r],n);return t},deepMerge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]="object"==typeof n?e({},n):n}for(var r=0,i=arguments.length;r<i;r++)o(arguments[r],n);return t},extend:function(e,t,n){return o(t,(function(t,r){e[r]=n&&"function"==typeof t?function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}},a=function(e,t,n,r,o){return function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}(new Error(e),t,n,r,o)};function u(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var c=function(e,t,n){if(!t)return e;var r;if(n)r=n(t);else if(i.isURLSearchParams(t))r=t.toString();else{var o=[];i.forEach(t,(function(e,t){null!=e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),o.push(u(t)+"="+u(e))})))})),r=o.join("&")}if(r){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e};const s=e=>null!==e&&"object"==typeof e;var f;!function(e){e[e.kUnknown=0]="kUnknown",e[e.kWechat=1]="kWechat",e[e.kAlipay=2]="kAlipay",e[e.kBaidu=3]="kBaidu"}(f||(f={}));const l=s(global.wx)?f.kWechat:s(global.my)?f.kAlipay:s(global.swan)?f.kBaidu:f.kUnknown,d=l===f.kWechat?wx.request.bind(wx):l===f.kAlipay?(my.request||my.httpRequest).bind(my):l===f.kBaidu?swan.request.bind(swan):void 0;function p(){let e;return{send(t){d&&(e=d(t))},abort(){e&&e.abort()}}}const h=e=>"string"==typeof e;export default function(e){return new Promise((function(t,n){const{url:r,data:o,headers:u,method:s,params:d,paramsSerializer:m,responseType:b,timeout:y,cancelToken:g}=e;if(e.auth){const[t,n]=[e.auth.username||"",e.auth.password||""];u.Authorization=`Basic ${function(e){const t=String(e);let n,r,o=0,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a="";for(;t.charAt(0|o)||(i="=",o%1);a+=i.charAt(63&n>>8-o%1*8)){if(r=t.charCodeAt(o+=.75),r>255)throw new Error('"btoa" failed: The string to be encoded contains characters outside of the Latin1 range.');n=n<<8|r}return a}(`${t}:${n}`)}`}i.forEach(u,(e,t)=>{const n=t.toLowerCase();(void 0===o&&"content-type"===n||"referer"===n)&&delete u[t]});let v=function(e){let t,n,r,o,i,u;const c=p();return{send(s){c.send({...s,success:t=>{const n=t.header||t.headers,r=t.statusCode||t.status||200,o=200===r?"OK":400===r?"Bad Request":"";u&&u({data:t.data,status:r,statusText:o,headers:n,config:e,request:s})},fail:t=>{let n=!1,u=!1;switch(l){case f.kWechat:-1!==t.errMsg.indexOf("request:fail abort")?n=!0:-1!==t.errMsg.indexOf("timeout")&&(u=!0);break;case f.kAlipay:[14,19].includes(t.error)?n=!0:[13].includes(t.error)&&(u=!0)}const c=n?a("Request aborted",e,"ECONNABORTED",""):u?a("Request Timeout",e,"ECONNABORTED",""):a("Network Error",e,null,"");n&&r&&r(c),u&&i&&i(c),o&&o(c)},complete:()=>{t&&(clearTimeout(t),t=void 0)}}),n&&(t=setTimeout(()=>{i&&i(a(`timeout of ${e.timeout||0}ms exceeded`,e,"ECONNABORTED","")),t=void 0},n))},abort(){c.abort()},set timeout(e){n=e},set onabort(e){r=e},set onerror(e){o=e},set ontimeout(e){i=e},set onsuccess(e){u=e}}}(e);const w={url:c(r,d,m),headers:u,method:s&&s.toUpperCase(),data:h(o)?JSON.parse(o):o,responseType:b};g&&g.promise.then(e=>{v&&(v.abort(),n(e),v=null)}),v.timeout=y,v.onsuccess=function(e){!function(e,t,n){var r=n.config.validateStatus;!r||r(n.status)?e(n):t(a("Request failed with status code "+n.status,n.config,null,n.request,n))}(t,n,e),v=null},v.onabort=function(e){v&&(n(e),v=null)},v.onerror=function(e){v&&(n(e),v=null)},v.ontimeout=function(e){n(e),v=null},v.send(w)}))}export{h as isString};
